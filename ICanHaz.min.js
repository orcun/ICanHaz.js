(function(f){var k=function(){var d=function(){};d.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":!0},context:{},render:function(a,b,c,e){if(!e)this.context=b,this.buffer=[];if(!this.includes("",a))if(e)return a;else{this.send(a);return}a=this.render_code(a);a=this.render_pragmas(a);a=this.render_section(a,b,c);if(e)return this.render_tags(a,b,c,e);this.render_tags(a,b,c,e)},send:function(a){a!=""&&this.buffer.push(a)},render_code:function(a){if(!this.includes("*",
a))return a;return a.replace(RegExp(this.otag+"\\*\\s*(.+?)\\s*"+this.ctag,"mg"),function(a,c){return eval(c)})},render_pragmas:function(a){if(!this.includes("%",a))return a;var b=this;return a.replace(RegExp(this.otag+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+this.ctag),function(a,e,h){if(!b.pragmas_implemented[e])throw{message:"This implementation of mustache doesn't understand the '"+e+"' pragma"};b.pragmas[e]={};h&&(a=h.split("="),b.pragmas[e][a[0]]=a[1]);return""})},render_partial:function(a,b,c){a=this.trim(a);
if(!c||c[a]===void 0)throw{message:"unknown_partial '"+a+"'"};if(typeof b[a]!="object")return this.render(c[a],b,c,!0);return this.render(c[a],b[a],c,!0)},render_section:function(a,b,c){if(!this.includes("#",a)&&!this.includes("^",a))return a;var e=this;return a.replace(RegExp(this.otag+"(\\^|\\#)\\s*(.+)\\s*"+this.ctag+"\n*([\\s\\S]+?)"+this.otag+"\\/\\s*\\2\\s*"+this.ctag+"\\s*","mg"),function(a,d,f,g){a=e.find(f,b);if(d=="^")return!a||e.is_array(a)&&a.length===0?e.render(g,b,c,!0):"";else if(d==
"#")return e.is_array(a)?e.map(a,function(a){return e.render(g,e.create_context(a),c,!0)}).join(""):e.is_object(a)?e.render(g,e.create_context(a),c,!0):typeof a==="function"?a.call(b,g,function(a){return e.render(a,b,c,!0)}):a?e.render(g,b,c,!0):""})},render_tags:function(a,b,c,e){for(var d=this,f=function(){return RegExp(d.otag+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+d.ctag+"+","g")},j=f(),g=function(a,e,g){switch(e){case "!":return"";case "=":return d.set_delimiters(g),j=f(),"";case ">":return d.render_partial(g,
b,c);case "{":return d.find(g,b);default:return d.escape(d.find(g,b))}},a=a.split("\n"),i=0;i<a.length;i++)a[i]=a[i].replace(j,g,this),e||this.send(a[i]);if(e)return a.join("\n")},set_delimiters:function(a){a=a.split(" ");this.otag=this.escape_regex(a[0]);this.ctag=this.escape_regex(a[1])},escape_regex:function(a){if(!arguments.callee.sRE)arguments.callee.sRE=RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","g");return a.replace(arguments.callee.sRE,"\\$1")},find:function(a,b){var a=
this.trim(a),c;b[a]===!1||b[a]===0||b[a]?c=b[a]:(this.context[a]===!1||this.context[a]===0||this.context[a])&&(c=this.context[a]);if(typeof c==="function")return c.apply(b);if(c!==void 0)return c;return""},includes:function(a,b){return b.indexOf(this.otag+a)!=-1},escape:function(a){return String(a===null?"":a).replace(/&(?!\w+;)|["<>\\]/g,function(a){switch(a){case "&":return"&amp;";case "\\":return"\\\\";case '"':return'"';case "<":return"&lt;";case ">":return"&gt;";default:return a}})},create_context:function(a){if(this.is_object(a))return a;
else{var b=".";if(this.pragmas["IMPLICIT-ITERATOR"])b=this.pragmas["IMPLICIT-ITERATOR"].iterator;var c={};c[b]=a;return c}},is_object:function(a){return a&&typeof a=="object"},is_array:function(a){return Object.prototype.toString.call(a)==="[object Array]"},trim:function(a){return a.replace(/^\s*|\s*$/g,"")},map:function(a,b){if(typeof a.map=="function")return a.map(b);else{for(var c=[],e=a.length,d=0;d<e;d++)c.push(b(a[d]));return c}}};return{name:"mustache.js",version:"0.3.0",to_html:function(a,
b,c,e){var f=new d;if(e)f.send=e;f.render(a,b,c);if(!e)return f.buffer.join("\n")}}}();window.ich=new function(){var d=this;d.VERSION="0.9";d.templates={};d.partials={};d.addTemplate=function(a,b){if(d[a])throw"Invalid name: "+a+".";if(d.templates[a])throw'Template " + name + " exists';d.templates[a]=b;d[a]=function(c,b){var c=c||{},h=k.to_html(d.templates[a],c,d.partials);return b?h:f(h)}};d.addPartial=function(a,b){if(d.partials[a])throw'Partial " + name + " exists';else d.partials[a]=b};d.grabTemplates=
function(){f('script[type="text/html"]').each(function(a,b){var c=f(typeof a==="number"?b:a),e="".trim?c.html().trim():f.trim(c.html());d[c.hasClass("partial")?"addPartial":"addTemplate"](c.attr("id"),e);c.remove()})};d.clearAll=function(){for(var a in d.templates)delete d[a];d.templates={};d.partials={}};d.refresh=function(){d.clearAll();d.grabTemplates()}};f(function(){ich.grabTemplates()})})(window.jQuery||window.Zepto);
